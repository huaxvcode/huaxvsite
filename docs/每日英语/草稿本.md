import sys
from os import system
import pymysql

db = pymysql.connect(
    host = "localhost",
    port = 3306,
    user = "huaxvubuntu",
    password = "huaxvubuntu",
    database = "learn_db"
)

cr = db.cursor()

def today():
    ls = set()
    for i in [0, 1, 2, 4, 8, 16, 32]:
        cr.execute(f"select name from learn_tb where datediff(curdate(), date_create)=%s" % (i, ))
        temp = cr.fetchall()
        for _ in temp:
            ls.insert(_)
    return list(ls)

def all():
    ls = set()
    cr.execute("select name from learn_tb;")
    for i in cr.fetchall():
        ls.insert(i)
    return ls

def insert(s):
    cr.execute(f'insert into learn_tb (name, date_create) values ("%s", curdate());')
    

# python3 -u learn.py
if __name__ == "__main__":
    args = list(sys.argv)[1:]
    s = ""
    c = args[0]
    for i in args[1:]:
        s += i + " "
    s = s[:-1]
    if c == "insert":
        insert(s)
    elif c == "all":
        all()
